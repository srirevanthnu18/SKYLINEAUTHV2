{% extends "base.html" %}
{% block title %}SKYLINE- Profile{% endblock %}
{% block page_title %}Profile{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h3><i class="fas fa-user-circle"></i> Account Information</h3>
    </div>
    <div style="display:flex; gap:30px; margin-bottom:24px;">
        <!-- Profile Picture -->
        <div style="flex-shrink:0; text-align:center;">
            <div class="profile-pic-container">
                {% if admin.profile_pic %}
                <img src="{{ url_for('static', filename='uploads/' + admin.profile_pic) }}" alt="Profile"
                    class="profile-pic">
                {% else %}
                <div class="profile-pic-placeholder">
                    <i class="fas fa-user"></i>
                </div>
                {% endif %}
            </div>
            <form method="POST" action="{{ url_for('profile.upload_pic') }}" enctype="multipart/form-data"
                style="margin-top:10px;">
                <label class="btn btn-sm btn-outline" style="cursor:pointer;">
                    <i class="fas fa-camera"></i> Change Photo
                    <input type="file" name="profile_pic" accept="image/*" style="display:none;"
                        onchange="this.form.submit()">
                </label>
            </form>
        </div>
        <!-- Account Details -->
        <div style="flex:1; display:grid; grid-template-columns:1fr 1fr; gap:20px;">
            <div>
                <div class="text-muted" style="font-size:12px; margin-bottom:4px;">Username</div>
                <div style="font-size:16px; font-weight:600;">{{ admin.username }}</div>
            </div>
            <div>
                <div class="text-muted" style="font-size:12px; margin-bottom:4px;">Role</div>
                <div>
                    <span class="badge badge-active" style="font-size:13px; padding:4px 14px;">
                        {{ admin.role|replace('superadmin','Super
                        Admin')|replace('admin','Admin')|replace('reseller','Reseller') }}
                    </span>
                </div>
            </div>
            <div>
                <div class="text-muted" style="font-size:12px; margin-bottom:4px;">Email</div>
                <div style="font-size:16px;">{{ admin.email or 'Not set' }}</div>
            </div>
            <div>
                <div class="text-muted" style="font-size:12px; margin-bottom:4px;">Joined</div>
                <div style="font-size:16px;">{{ admin.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
            </div>
            <div>
                <div class="text-muted" style="font-size:12px; margin-bottom:4px;"><i class="fas fa-globe"></i> Last
                    Login IP</div>
                <div style="font-size:16px; font-family:monospace;">{{ admin.last_login_ip or 'N/A' }}</div>
            </div>
            <div>
                <div class="text-muted" style="font-size:12px; margin-bottom:4px;"><i class="fas fa-clock"></i> Last
                    Login</div>
                <div style="font-size:16px;">
                    {% if admin.last_login_at %}
                    {{ admin.last_login_at.strftime('%Y-%m-%d %H:%M') }}
                    {% else %}
                    N/A
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h3><i class="fas fa-edit"></i> Update Profile</h3>
    </div>
    <form method="POST" action="{{ url_for('profile.update') }}">
        {% if admin.role == 'superadmin' %}
        <div class="form-row">
            <div class="form-group">
                <label>Username <small class="text-muted">(Super Admin only)</small></label>
                <input type="text" name="username" class="form-control" value="{{ admin.username }}"
                    placeholder="Your username">
            </div>
        </div>
        {% endif %}
        <div class="form-row">
            <div class="form-group">
                <label>Email</label>
                <input type="email" name="email" class="form-control" value="{{ admin.email or '' }}"
                    placeholder="Your email">
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label>New Password</label>
                <input type="password" name="password" class="form-control" placeholder="Leave blank to keep current">
            </div>
            <div class="form-group">
                <label>Confirm Password</label>
                <input type="password" name="confirm_password" class="form-control" placeholder="Confirm new password">
            </div>
        </div>
        <button type="submit" class="btn btn-primary mt-2"><i class="fas fa-save"></i> Update Profile</button>
    </form>
</div>

<style>
    .profile-pic-container {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        overflow: hidden;
        border: 3px solid #333;
    }

    .profile-pic {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .profile-pic-placeholder {
        width: 100%;
        height: 100%;
        background: #1a1a2e;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .profile-pic-placeholder i {
        font-size: 48px;
        color: #555;
    }
</style>
{% endblock %}